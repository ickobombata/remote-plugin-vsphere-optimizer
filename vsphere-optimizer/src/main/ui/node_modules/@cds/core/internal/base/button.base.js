import{__decorate as e}from"tslib";import{LitElement as t,html as i,render as r}from"lit";import{ifDefined as s}from"lit/directives/if-defined.js";import{property as o,state as a}from"../decorators/property.js";import{querySlot as n}from"../decorators/query-slot.js";import{onAnyKey as h}from"../utils/keycodes.js";import{stopEvent as d}from"../utils/events.js";class l extends t{constructor(){super(...arguments);this.readonly=!1,this.disabled=!1,this.focused=!1,this.active=!1,this.isAnchor=!1,this.explicitClick=!1,this.markerSignificantProperties=["type","name","value","disabled"]}render(){return i`<slot></slot>`}connectedCallback(){super.connectedCallback(),this.tabIndex=0,this.role="button"}updated(e){this.hasMarkerSignificantProperty(e)&&(this.markerAttached&&this.marker.remove(),this.createMarker()),super.updated(e),this.updateButtonAttributes(),this.addDefaultSubmitBehavior(),e.has("readonly")&&this.setupNativeButtonBehavior()}emulateActiveMouseDown(){this.disabled||this.readonly||(this.active=!0)}emulateActiveMouseUp(){this.active=!1,this.explicitClick=!0}setupNativeButtonBehavior(){this.readonly?(this.removeEventListener("keyup",this.emulateActiveMouseUp),this.removeEventListener("keydown",this.emulateActiveMouseDown),this.removeEventListener("mouseup",this.emulateActiveMouseUp),this.removeEventListener("mousedown",this.emulateActiveMouseDown),this.removeEventListener("click",this.triggerNativeButtonBehavior),this.removeEventListener("keyup",this.emulateKeyBoardEventBehavior)):(this.addEventListener("keyup",this.emulateActiveMouseUp),this.addEventListener("keydown",this.emulateActiveMouseDown),this.addEventListener("mouseup",this.emulateActiveMouseUp),this.addEventListener("mousedown",this.emulateActiveMouseDown),this.addEventListener("click",this.triggerNativeButtonBehavior),this.addEventListener("keyup",this.emulateKeyBoardEventBehavior))}triggerNativeButtonBehavior(e){var t;this.readonly||(this.disabled?d(e):!e.defaultPrevented&&this.marker&&this.explicitClick&&(this.markerAttached||this.appendChild(this.marker),null===(t=this.querySelector("button[aria-hidden]"))||void 0===t||t.dispatchEvent(new MouseEvent("click",{relatedTarget:this,composed:!0})),"submit"!==this.type&&this.marker.remove())),this.explicitClick=!1}createMarker(){const e=i`<button aria-hidden="true" role="presentation" ?disabled="${this.disabled}" tabindex="-1" style="display:none!important" value="${s(this.value)}" name="${s(this.name)}" type="${s(this.type)}"></button>`,t=document.createElement("div");t.style.display="none",r(e,t),this.marker=t}get markerAttached(){return!(!this.marker||!this.marker.parentElement)}hasMarkerSignificantProperty(e){for(const t of this.markerSignificantProperties)if(e.has(t))return!0;return!1}emulateKeyBoardEventBehavior(e){h(["enter","space"],e,(()=>{this.readonly||(this.click(),d(e))}))}updateButtonAttributes(){var e;this.isAnchor="A"===(null===(e=this.parentElement)||void 0===e?void 0:e.tagName),this.isAnchor&&this.parentElement&&(this.parentElement.style.lineHeight="0",this.parentElement.style.textDecoration="none"),this.readonly=this.readonly||this.isAnchor,this.readonly?(this.role=null,this.tabIndexAttr=null,this.ariaDisabled=null):(this.role="button",this.tabIndexAttr=this.disabled?-1:0,this.ariaDisabled=this.disabled?"true":"false")}addDefaultSubmitBehavior(){!this.type&&this.closest("form")&&(this.type="submit"),"submit"!==this.type||this.markerAttached||this.appendChild(this.marker)}}e([o({type:Boolean})],l.prototype,"readonly",void 0),e([o({type:String})],l.prototype,"type",void 0),e([o({type:String})],l.prototype,"name",void 0),e([o({type:String})],l.prototype,"value",void 0),e([o({type:Boolean})],l.prototype,"disabled",void 0),e([a({type:Number,attribute:"tabindex",reflect:!0})],l.prototype,"tabIndexAttr",void 0),e([a({type:Boolean,reflect:!0})],l.prototype,"focused",void 0),e([a({type:Boolean,reflect:!0})],l.prototype,"active",void 0),e([a({type:Boolean,reflect:!0})],l.prototype,"isAnchor",void 0),e([n("cds-icon")],l.prototype,"icon",void 0),e([n("cds-badge")],l.prototype,"badge",void 0);export{l as CdsBaseButton};
//# sourceMappingURL=button.base.js.map
