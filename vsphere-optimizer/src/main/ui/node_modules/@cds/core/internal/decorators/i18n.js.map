{"version":3,"file":"i18n.js","sources":["../../../../src/internal/decorators/i18n.ts"],"sourcesContent":["/*\n * Copyright (c) 2016-2022 VMware, Inc. All Rights Reserved.\n * This software is released under MIT license.\n * The full license information can be found in LICENSE in the root directory of this project.\n */\nimport { property } from 'lit/decorators/property.js';\nimport { GlobalStateService } from '../services/global.service.js';\nimport { I18nService } from '../services/i18n.service.js';\n// Legacy TS Decorator\nfunction legacyI18n(descriptor, protoOrDescriptor, name) {\n    const desc = Object.defineProperty(protoOrDescriptor, name, descriptor);\n    return property({ type: Object, attribute: 'cds-i18n' })(desc, name);\n}\n// TC39 Decorators proposal\nfunction standardI18n(descriptor, element) {\n    const desc = {\n        kind: 'method',\n        placement: 'prototype',\n        key: element.key,\n        descriptor,\n    };\n    return property({ type: Object })(desc);\n}\n/**\n * A property decorator which accesses a set of string values for use\n * inside the element's template. The values can be overridden at runtime\n * by changing the property value that's reflected through the attribute value.\n *\n * @example\n *\n *     class MyElement {\n *       @i18n()\n *       i18n = {\n *         \"open\" : \"Open my element\",\n *         \"close\" : \"Close my element\"\n *       };\n *     }\n *\n */\nexport function i18n() {\n    return (protoOrDescriptor, name) => {\n        const targetConnectedCallback = protoOrDescriptor.connectedCallback;\n        const targetDisconnectedCallback = protoOrDescriptor.disconnectedCallback;\n        function connectedCallback() {\n            protoOrDescriptor.__i18nSub = GlobalStateService.stateUpdates.subscribe(update => {\n                if (update.key === 'i18nRegistry') {\n                    this.requestUpdate(name);\n                }\n            });\n            if (targetConnectedCallback) {\n                targetConnectedCallback.apply(this);\n            }\n        }\n        function disconnectedCallback() {\n            protoOrDescriptor.__i18nSub.unsubscribe();\n            if (targetDisconnectedCallback) {\n                targetDisconnectedCallback.apply(this);\n            }\n        }\n        protoOrDescriptor.connectedCallback = connectedCallback;\n        protoOrDescriptor.disconnectedCallback = disconnectedCallback;\n        const descriptor = {\n            get() {\n                return { ...I18nService.keys[this.__i18nKey], ...this.__i18n };\n            },\n            set(value) {\n                this.__i18nKey = Object.keys(I18nService.keys).find(key => I18nService.keys[key] === value);\n                if (!this.__i18nKey) {\n                    this.__i18n = value;\n                }\n            },\n            enumerable: true,\n            configurable: true,\n        };\n        return name !== undefined\n            ? legacyI18n(descriptor, protoOrDescriptor, name)\n            : standardI18n(descriptor, protoOrDescriptor);\n    };\n}\n"],"names":["i18n","protoOrDescriptor","name","targetConnectedCallback","connectedCallback","targetDisconnectedCallback","disconnectedCallback","__i18nSub","GlobalStateService","stateUpdates","subscribe","update","key","this","requestUpdate","apply","unsubscribe","descriptor","get","I18nService","keys","__i18nKey","__i18n","set","value","Object","find","enumerable","configurable","undefined","desc","defineProperty","property","type","attribute","legacyI18n","element","kind","placement","standardI18n"],"mappings":"mLAuCO,SAASA,IACZ,MAAO,CAACC,EAAmBC,KACvB,MAAMC,EAA0BF,EAAkBG,kBAC5CC,EAA6BJ,EAAkBK,qBAiBrDL,EAAkBG,kBAhBlB,WACIH,EAAkBM,UAAYC,EAAmBC,aAAaC,WAAUC,IACjD,iBAAfA,EAAOC,KACPC,KAAKC,cAAcZ,MAGvBC,GACAA,EAAwBY,MAAMF,OAUtCZ,EAAkBK,qBAPlB,WACIL,EAAkBM,UAAUS,cACxBX,GACAA,EAA2BU,MAAMF,OAKzC,MAAMI,EAAa,CACfC,MACI,MAAO,IAAKC,EAAYC,KAAKP,KAAKQ,cAAeR,KAAKS,SAE1DC,IAAIC,GACAX,KAAKQ,UAAYI,OAAOL,KAAKD,EAAYC,MAAMM,MAAKd,GAAOO,EAAYC,KAAKR,KAASY,IAChFX,KAAKQ,YACNR,KAAKS,OAASE,IAGtBG,YAAY,EACZC,cAAc,GAElB,YAAgBC,IAAT3B,EAjEf,SAAoBe,EAAYhB,EAAmBC,GAC/C,MAAM4B,EAAOL,OAAOM,eAAe9B,EAAmBC,EAAMe,GAC5D,OAAOe,EAAS,CAAEC,KAAMR,OAAQS,UAAW,YAApCF,CAAkDF,EAAM5B,GAgErDiC,CAAWlB,EAAYhB,EAAmBC,GA7DxD,SAAsBe,EAAYmB,GAC9B,MAAMN,EAAO,CACTO,KAAM,SACNC,UAAW,YACX1B,IAAKwB,EAAQxB,IACbK,WAAAA,GAEJ,OAAOe,EAAS,CAAEC,KAAMR,QAAjBO,CAA2BF,GAuDxBS,CAAatB,EAAYhB"}