{"version":3,"file":"file.element.js","sources":["../../../src/file/file.element.ts"],"sourcesContent":["/*\n * Copyright (c) 2016-2022 VMware, Inc. All Rights Reserved.\n * This software is released under MIT license.\n * The full license information can be found in LICENSE in the root directory of this project.\n */\nimport { __decorate } from \"tslib\";\nimport { html } from 'lit';\nimport { state, i18n, I18nService } from '@cds/core/internal';\nimport { CdsControl } from '@cds/core/forms';\nimport { ClarityIcons } from '@cds/core/icon/icon.service.js';\nimport { folderIcon } from '@cds/core/icon/shapes/folder.js';\nimport { timesIcon } from '@cds/core/icon/shapes/times.js';\nimport styles from './file.element.scss';\n/**\n * Time Input\n *\n * ```typescript\n * import '@cds/core/file/register.js';\n * ```\n *\n * ```html\n * <cds-file>\n *   <label>file</label>\n *   <input type=\"file\" />\n * </cds-file>\n * ```\n *\n * @element cds-file\n * @slot - For projecting file input and label\n */\nexport class CdsFile extends CdsControl {\n    constructor() {\n        super();\n        this.i18n = I18nService.keys.file;\n        this.buttonLabel = this.i18n.browse;\n        this.fixedControlWidth = true;\n        this.supportsPrefixSuffixActions = false;\n        ClarityIcons.addIcons(folderIcon, timesIcon);\n    }\n    static get styles() {\n        return [...super.styles, styles];\n    }\n    get inputTemplate() {\n        return html `\n      <div>\n        <cds-button size=\"sm\" action=\"outline\" @click=\"${() => this.label.click()}\" ?disabled=${this.disabled}>\n          <cds-icon shape=\"folder\" aria-hidden=\"true\"></cds-icon>\n          <span>${this.buttonLabel}</span>\n        </cds-button>\n        ${this.clearFilesControlTemplate}\n      </div>\n    `;\n    }\n    get clearFilesControlTemplate() {\n        var _a;\n        return ((_a = this.inputControl.files) === null || _a === void 0 ? void 0 : _a.length) && !this.disabled\n            ? html ` <cds-control-action @click=\"${() => this.clearFiles()}\" aria-label=\"${this.i18n.removeFile}\">\n          <cds-icon shape=\"times\"></cds-icon>\n        </cds-control-action>`\n            : html ``;\n    }\n    firstUpdated(props) {\n        super.firstUpdated(props);\n        this.inputControl.addEventListener('change', e => {\n            // NOTE: have to distinguish here being user-caused events and programmatic\n            // events (e.isTrusted true/false) so that we don't fire a change event loop\n            if (e.isTrusted) {\n                this.updateLabelAndFocus(e.target.files);\n            }\n        });\n    }\n    /** @private */\n    clearFiles(fireEvent = true) {\n        var _a;\n        this.buttonLabel = this.i18n.browse;\n        this.inputControl.value = '';\n        // when input is reset like this it isn't registering an onchange event\n        // NOTE: tsc + karma is complaining about dispatchEvent being a method on inputControl\n        if (fireEvent && this.inputControl.dispatchEvent) {\n            this.inputControl.dispatchEvent(new Event('change'));\n        }\n        const browseButton = (_a = this.shadowRoot) === null || _a === void 0 ? void 0 : _a.querySelector('cds-button');\n        if (browseButton) {\n            browseButton.focus();\n        }\n    }\n    /** @private */\n    updateLabelAndFocus(files) {\n        if (files && files.length) {\n            this.buttonLabel = files.length > 1 ? `${files.length} ${this.i18n.files}` : files[0].name;\n        }\n        else {\n            this.clearFiles(false);\n        }\n    }\n}\n__decorate([\n    i18n()\n], CdsFile.prototype, \"i18n\", void 0);\n__decorate([\n    state()\n], CdsFile.prototype, \"buttonLabel\", void 0);\n__decorate([\n    state()\n], CdsFile.prototype, \"fixedControlWidth\", void 0);\n__decorate([\n    state()\n], CdsFile.prototype, \"supportsPrefixSuffixActions\", void 0);\n"],"names":["CdsFile","CdsControl","constructor","super","this","i18n","I18nService","keys","file","buttonLabel","browse","fixedControlWidth","supportsPrefixSuffixActions","ClarityIcons","addIcons","folderIcon","timesIcon","styles","inputTemplate","html","label","click","disabled","clearFilesControlTemplate","_a","inputControl","files","length","clearFiles","removeFile","firstUpdated","props","addEventListener","e","isTrusted","updateLabelAndFocus","target","fireEvent","value","dispatchEvent","Event","browseButton","shadowRoot","querySelector","focus","name","__decorate","prototype","state"],"mappings":"6YA8BO,MAAMA,UAAgBC,EACzBC,cACIC,QACAC,KAAKC,KAAOC,EAAYC,KAAKC,KAC7BJ,KAAKK,YAAcL,KAAKC,KAAKK,OAC7BN,KAAKO,mBAAoB,EACzBP,KAAKQ,6BAA8B,EACnCC,EAAaC,SAASC,EAAYC,GAE3BC,oBACP,MAAO,IAAId,MAAMc,OAAQA,GAEzBC,oBACA,OAAOC,CAAK,uDAEqC,IAAMf,KAAKgB,MAAMC,uBAAsBjB,KAAKkB,0EAEnFlB,KAAKK,kCAEbL,KAAKmB,kCAIPA,gCACA,IAAIC,EACJ,OAA2C,QAAlCA,EAAKpB,KAAKqB,aAAaC,aAA0B,IAAPF,OAAgB,EAASA,EAAGG,UAAYvB,KAAKkB,SAC1FH,CAAK,+BAAgC,IAAMf,KAAKwB,6BAA6BxB,KAAKC,KAAKwB,uEAGvFV,CAAK,GAEfW,aAAaC,GACT5B,MAAM2B,aAAaC,GACnB3B,KAAKqB,aAAaO,iBAAiB,UAAUC,IAGrCA,EAAEC,WACF9B,KAAK+B,oBAAoBF,EAAEG,OAAOV,UAK9CE,WAAWS,GAAY,GACnB,IAAIb,EACJpB,KAAKK,YAAcL,KAAKC,KAAKK,OAC7BN,KAAKqB,aAAaa,MAAQ,GAGtBD,GAAajC,KAAKqB,aAAac,eAC/BnC,KAAKqB,aAAac,cAAc,IAAIC,MAAM,WAE9C,MAAMC,EAA0C,QAA1BjB,EAAKpB,KAAKsC,kBAA+B,IAAPlB,OAAgB,EAASA,EAAGmB,cAAc,cAC9FF,GACAA,EAAaG,QAIrBT,oBAAoBT,GACZA,GAASA,EAAMC,OACfvB,KAAKK,YAAciB,EAAMC,OAAS,EAAI,GAAGD,EAAMC,UAAUvB,KAAKC,KAAKqB,QAAUA,EAAM,GAAGmB,KAGtFzC,KAAKwB,YAAW,IAI5BkB,EAAW,CACPzC,KACDL,EAAQ+C,UAAW,YAAQ,GAC9BD,EAAW,CACPE,KACDhD,EAAQ+C,UAAW,mBAAe,GACrCD,EAAW,CACPE,KACDhD,EAAQ+C,UAAW,yBAAqB,GAC3CD,EAAW,CACPE,KACDhD,EAAQ+C,UAAW,mCAA+B"}