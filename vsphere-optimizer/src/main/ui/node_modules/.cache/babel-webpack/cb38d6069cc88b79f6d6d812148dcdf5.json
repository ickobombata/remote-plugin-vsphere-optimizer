{"ast":null,"code":"/* Copyright (c) 2018-2023 VMware, Inc. All rights reserved. */\nimport { NgZone } from '@angular/core';\nimport { Chassis } from '~models/chassis.model';\nimport { MessageType } from '~models/message.model';\nimport { ChassisService } from '~services/chassis.service';\nimport { ModalConfigService } from '~services/modal.service';\nimport { GlobalService } from '~services/global.service';\nimport { MessagingService } from '~services/messaging.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"~services/chassis.service\";\nimport * as i2 from \"~services/global.service\";\nimport * as i3 from \"~services/modal.service\";\nimport * as i4 from \"~services/messaging.service\";\nimport * as i5 from \"@clr/angular\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"../status/status.component\";\nimport * as i8 from \"../details-view/details-view.component\";\nimport * as i9 from \"@ngx-translate/core\";\n\nfunction ListComponent_clr_dg_row_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"clr-dg-row\", 17);\n    i0.ɵɵelementStart(1, \"clr-dg-cell\");\n    i0.ɵɵelement(2, \"clr-icon\", 18);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"clr-dg-cell\");\n    i0.ɵɵelement(5, \"app-chassis-status\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const chassis_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"clrDgItem\", chassis_r5);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", chassis_r5.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"isActive\", chassis_r5.isActive);\n  }\n}\n\nfunction ListComponent_div_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(2, 1, \"list.noObjectsSelected\"), \" \");\n  }\n}\n\nfunction ListComponent_div_41_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(2, 1, \"list.multipleObjectsSelected\"), \" \");\n  }\n}\n\nfunction ListComponent_app_details_view_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-details-view\", 21);\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"chassis\", ctx_r4.selectedChassis[0]);\n  }\n}\n\nexport let ListComponent = /*#__PURE__*/(() => {\n  class ListComponent {\n    constructor(zone, chassisService, globalService, modalService, messagingService) {\n      this.zone = zone;\n      this.chassisService = chassisService;\n      this.globalService = globalService;\n      this.modalService = modalService;\n      this.messagingService = messagingService; // The current loading.\n\n      this.loading = false; // The loading that is scheduled to be run after the current loading\n      // completes.\n\n      this.scheduledLoading = false;\n    }\n\n    ngOnInit() {\n      this.chassisMap = new Map();\n      this.selectedChassis = [];\n      const navigationState = history.state;\n\n      if (navigationState && navigationState.selectedChassis) {\n        this.selectedChassis = navigationState.selectedChassis;\n      }\n\n      this.numberOfChassisPerPage = Chassis.DEFAULT_CHASSIS_PAGE_SIZE;\n      const persistedNumberOfChassisPerPage = parseInt(localStorage.getItem(Chassis.PROP_CHASSIS_PAGE_SIZE), 10);\n\n      if (persistedNumberOfChassisPerPage && persistedNumberOfChassisPerPage > 0) {\n        this.numberOfChassisPerPage = persistedNumberOfChassisPerPage;\n      }\n\n      this.globalService.htmlClientSdk.event.onGlobalRefresh(() => {\n        this.zone.run(() => {\n          this.refresh('explicit');\n        });\n      });\n      this.messagingService.messages$.subscribe(message => {\n        if (message.type !== MessageType.chassisUpdated) {\n          return;\n        }\n\n        this.refresh('implicit');\n      });\n      this.refresh('explicit');\n    }\n\n    onAdd() {\n      const config = this.modalService.createAddConfig();\n      this.globalService.htmlClientSdk.modal.open(config);\n    }\n\n    onAddWizard() {\n      const config = this.modalService.createAddWizardConfig();\n      this.globalService.htmlClientSdk.modal.open(config);\n    }\n\n    onDelete() {\n      const chassisNames = this.selectedChassis.map(chassis => chassis.name);\n      const config = this.modalService.createDeleteConfig(chassisNames, () => {\n        this.deleteChassis();\n      });\n      this.globalService.htmlClientSdk.modal.openConfirmationModal(config);\n    }\n\n    onEdit() {\n      const config = this.modalService.createEditConfig();\n      config.contextObjects = this.selectedChassis.map(value => Object.assign(new Chassis(), value));\n      this.globalService.htmlClientSdk.modal.open(config);\n    }\n    /**\n     * Returns array of chassis objects.\n     */\n\n\n    get chassisList() {\n      if (this.chassisMap) {\n        return Array.from(this.chassisMap.values());\n      }\n\n      return null;\n    }\n    /**\n     * Refresh the list of chassis objects.\n     */\n\n\n    refresh(refreshTrigger) {\n      // If a loading is already running then schedule a loading to be\n      // run after the current loading completes.\n      if (this.loading) {\n        // If an explicit refresh is triggered make the current loading explicit.\n        if (refreshTrigger === 'explicit') {\n          this.loading = 'explicit';\n        } // If there is no explicit loading that is already scheduled, schedule\n        // a loading with the specified type.\n\n\n        if (this.scheduledLoading !== 'explicit') {\n          this.scheduledLoading = refreshTrigger;\n        }\n\n        return;\n      }\n\n      this.loading = refreshTrigger;\n      this.chassisService.getAllChassis().subscribe(result => {\n        this.loading = false;\n\n        if (this.scheduledLoading) {\n          const scheduledRefreshTrigger = this.scheduledLoading;\n          this.scheduledLoading = false;\n          this.refresh(scheduledRefreshTrigger);\n        }\n\n        const oldSelectedChassisIds = {};\n        this.selectedChassis.forEach(item => oldSelectedChassisIds[item.id] = undefined);\n        this.selectedChassis = [];\n        this.chassisMap = new Map();\n        result.forEach(item => {\n          this.chassisMap.set(item.id, item);\n\n          if (oldSelectedChassisIds.hasOwnProperty(item.id)) {\n            this.selectedChassis.push(item);\n          }\n        });\n      });\n    }\n    /**\n     * Handler for the OK button of Delete Chassis Confirmation Modal.\n     * On successful delete removes the deleted chassis from the list.\n     */\n\n\n    deleteChassis() {\n      const chassisIds = this.selectedChassis.map(chassis => chassis.id);\n      this.chassisService.remove(chassisIds).subscribe();\n    }\n\n  }\n\n  ListComponent.ɵfac = function ListComponent_Factory(t) {\n    return new (t || ListComponent)(i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(i1.ChassisService), i0.ɵɵdirectiveInject(i2.GlobalService), i0.ɵɵdirectiveInject(i3.ModalConfigService), i0.ɵɵdirectiveInject(i4.MessagingService));\n  };\n\n  ListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ListComponent,\n    selectors: [[\"ng-component\"]],\n    decls: 43,\n    vars: 37,\n    consts: [[1, \"viewTitle\"], [1, \"chassis-list-view\"], [1, \"chassises-datagrid-container\"], [3, \"clrDgLoading\", \"clrDgSelected\", \"clrDgRowSelection\", \"clrDgSelectedChange\"], [1, \"btn-group\"], [\"type\", \"button\", 1, \"btn\", \"btn-sm\", \"btn-secondary\", 3, \"click\"], [\"shape\", \"plus\"], [\"type\", \"button\", 1, \"btn\", \"btn-sm\", \"btn-secondary\", 3, \"disabled\", \"click\"], [\"shape\", \"pencil\"], [\"shape\", \"times-circle\"], [3, \"clrDgItem\", 4, \"clrDgItems\", \"clrDgItemsOf\"], [3, \"clrDgPageSize\"], [\"pagination\", \"\"], [1, \"splitter\"], [1, \"details-container\"], [\"class\", \"details-message\", 4, \"ngIf\"], [3, \"chassis\", 4, \"ngIf\"], [3, \"clrDgItem\"], [\"shape\", \"chassisIcon\"], [3, \"isActive\"], [1, \"details-message\"], [3, \"chassis\"]],\n    template: function ListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtext(1);\n        i0.ɵɵpipe(2, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"div\", 1);\n        i0.ɵɵelementStart(4, \"div\", 2);\n        i0.ɵɵelementStart(5, \"clr-datagrid\", 3);\n        i0.ɵɵlistener(\"clrDgSelectedChange\", function ListComponent_Template_clr_datagrid_clrDgSelectedChange_5_listener($event) {\n          return ctx.selectedChassis = $event;\n        });\n        i0.ɵɵelementStart(6, \"clr-dg-placeholder\");\n        i0.ɵɵtext(7);\n        i0.ɵɵpipe(8, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"clr-dg-action-bar\");\n        i0.ɵɵelementStart(10, \"div\", 4);\n        i0.ɵɵelementStart(11, \"button\", 5);\n        i0.ɵɵlistener(\"click\", function ListComponent_Template_button_click_11_listener() {\n          return ctx.onAdd();\n        });\n        i0.ɵɵelement(12, \"clr-icon\", 6);\n        i0.ɵɵtext(13);\n        i0.ɵɵpipe(14, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"button\", 5);\n        i0.ɵɵlistener(\"click\", function ListComponent_Template_button_click_15_listener() {\n          return ctx.onAddWizard();\n        });\n        i0.ɵɵelement(16, \"clr-icon\", 6);\n        i0.ɵɵtext(17);\n        i0.ɵɵpipe(18, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"button\", 7);\n        i0.ɵɵlistener(\"click\", function ListComponent_Template_button_click_19_listener() {\n          return ctx.onEdit();\n        });\n        i0.ɵɵelement(20, \"clr-icon\", 8);\n        i0.ɵɵtext(21);\n        i0.ɵɵpipe(22, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"button\", 7);\n        i0.ɵɵlistener(\"click\", function ListComponent_Template_button_click_23_listener() {\n          return ctx.onDelete();\n        });\n        i0.ɵɵelement(24, \"clr-icon\", 9);\n        i0.ɵɵtext(25);\n        i0.ɵɵpipe(26, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"clr-dg-column\");\n        i0.ɵɵtext(28);\n        i0.ɵɵpipe(29, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"clr-dg-column\");\n        i0.ɵɵtext(31);\n        i0.ɵɵpipe(32, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(33, ListComponent_clr_dg_row_33_Template, 6, 3, \"clr-dg-row\", 10);\n        i0.ɵɵelementStart(34, \"clr-dg-footer\");\n        i0.ɵɵelementStart(35, \"clr-dg-pagination\", 11, 12);\n        i0.ɵɵtext(37);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(38, \"div\", 13);\n        i0.ɵɵelementStart(39, \"div\", 14);\n        i0.ɵɵtemplate(40, ListComponent_div_40_Template, 3, 3, \"div\", 15);\n        i0.ɵɵtemplate(41, ListComponent_div_41_Template, 3, 3, \"div\", 15);\n        i0.ɵɵtemplate(42, ListComponent_app_details_view_42_Template, 1, 1, \"app-details-view\", 16);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(36);\n\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 21, \"list.chassisList\"));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"clrDgLoading\", ctx.loading === \"explicit\")(\"clrDgSelected\", ctx.selectedChassis)(\"clrDgRowSelection\", true);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(8, 23, \"list.noData\"), \" \");\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(14, 25, \"list.addChassis\"), \" \");\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(18, 27, \"list.addChassisWizard\"), \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", ctx.selectedChassis.length !== 1);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(22, 29, \"common.edit\"), \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", ctx.selectedChassis.length <= 0);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(26, 31, \"common.delete\"), \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(29, 33, \"common.name\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(32, 35, \"common.state\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"clrDgItemsOf\", ctx.chassisList);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"clrDgPageSize\", ctx.numberOfChassisPerPage);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate3(\" \", _r1.firstItem + 1, \" - \", _r1.lastItem + 1, \" of \", _r1.totalItems, \" chassis \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedChassis.length === 0);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedChassis.length > 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedChassis.length === 1);\n      }\n    },\n    directives: [i5.ClrDatagrid, i5.ÇlrDatagridMainRenderer, i5.ÇlrDatagridWillyWonka, i5.ÇlrActionableOompaLoompa, i5.ÇlrExpandableOompaLoompa, i5.ClrDatagridPlaceholder, i5.ClrDatagridActionBar, i5.ClrIconCustomTag, i5.ClrDatagridColumn, i5.ÇlrDatagridHeaderRenderer, i5.ClrDatagridItems, i5.ClrDatagridFooter, i5.ClrDatagridPagination, i6.NgIf, i5.ClrDatagridRow, i5.ÇlrDatagridRowRenderer, i5.ClrDatagridCell, i5.ÇlrDatagridCellRenderer, i7.StatusComponent, i8.DetailsViewComponent],\n    pipes: [i9.TranslatePipe],\n    styles: [\"[_nghost-%COMP%]{position:relative;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;width:100%;height:100%;min-height:100%}.chassis-list-view[_ngcontent-%COMP%]{-ms-flex:1 1 auto;flex:1 1 auto;display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;width:100%;height:100%}.datagrid-container[_ngcontent-%COMP%]{-ms-flex:0 0 auto;flex:0 0 auto;margin-right:40px}clr-datagrid[_ngcontent-%COMP%]{margin-top:-7px;min-width:400px;height:auto!important}.details-container[_ngcontent-%COMP%]{-ms-flex:1 1 100%;flex:1 1 100%}.details-message[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;width:100%;height:100%;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.splitter[_ngcontent-%COMP%]{-ms-flex:0 0 auto;flex:0 0 auto;width:1px;margin:0 20px;background-color:var(--border-color)}.spinner-overlay[_ngcontent-%COMP%]{position:absolute;z-index:1;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%;pointer-events:auto;background:var(--overlay-color)}\"]\n  });\n  return ListComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}