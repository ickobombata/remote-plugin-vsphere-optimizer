{"ast":null,"code":"import { Chassis } from '~models/chassis.model';\nimport { ChassisService } from '~services/chassis.service';\nimport { HostsService } from '~services/hosts.service';\nimport { Host } from '~models/host.model';\nimport { GlobalService } from '~services/global.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"~services/chassis.service\";\nimport * as i2 from \"~services/hosts.service\";\nimport * as i3 from \"~services/global.service\";\nimport * as i4 from \"@clr/angular\";\nimport * as i5 from \"../status/status.component\";\nimport * as i6 from \"@ngx-translate/core\";\n\nfunction HostMonitorComponent_clr_dg_row_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"clr-dg-row\", 7);\n    i0.ɵɵelementStart(1, \"clr-dg-cell\");\n    i0.ɵɵelementStart(2, \"a\", 8);\n    i0.ɵɵlistener(\"click\", function HostMonitorComponent_clr_dg_row_16_Template_a_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const chassis_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.navigateToChassis(chassis_r2);\n    })(\"contextmenu\", function HostMonitorComponent_clr_dg_row_16_Template_a_contextmenu_2_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.onContextMenu();\n    });\n    i0.ɵɵelement(3, \"clr-icon\", 9);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"clr-dg-cell\");\n    i0.ɵɵelement(6, \"app-chassis-status\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const chassis_r2 = ctx.$implicit;\n    i0.ɵɵproperty(\"clrDgItem\", chassis_r2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", chassis_r2.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"isActive\", chassis_r2.isActive);\n  }\n}\n\nexport let HostMonitorComponent = /*#__PURE__*/(() => {\n  class HostMonitorComponent {\n    constructor(chassisService, hostsService, globalService) {\n      this.chassisService = chassisService;\n      this.hostsService = hostsService;\n      this.globalService = globalService;\n      this.loading = true;\n      this.numberOfChassisPerPage = Chassis.DEFAULT_CHASSIS_PAGE_SIZE;\n    }\n\n    ngOnInit() {\n      const value = parseInt(localStorage.getItem(Chassis.PROP_CHASSIS_PAGE_SIZE), 10);\n\n      if (value && value > 0) {\n        this.numberOfChassisPerPage = value;\n      }\n\n      this.contextObjectId = this.globalService.htmlClientSdk.app.getContextObjects()[0].id;\n      this.loadData();\n    }\n\n    get selectedChassis() {\n      return this._selectedChassis;\n    }\n\n    set selectedChassis(chassis) {\n      this._selectedChassis = chassis;\n    }\n\n    updateChassisRelation() {\n      this.loading = true;\n      const host = new Host();\n      host.id = this.contextObjectId;\n      host.relatedChassisIds = this.selectedChassis.map(chassis => chassis.id);\n      this.hostsService.edit(host).subscribe({\n        error: () => this.loading = false,\n        complete: () => this.loading = false\n      });\n    }\n\n    onContextMenu() {\n      return false;\n    }\n\n    navigateToChassis(selectedChassis) {\n      this.globalService.htmlClientSdk.app.navigateTo({\n        targetViewId: 'entryPoint',\n        customData: {\n          navigationPath: '/entry-point/list',\n          selectedChassis: [selectedChassis]\n        }\n      });\n    }\n\n    loadData() {\n      this.chassisService.getAllChassis().subscribe(chassis => {\n        this.chassisList = chassis;\n        this.selectedChassis = this.filterRelatedChassis();\n        this.loading = false;\n      });\n    }\n\n    filterRelatedChassis() {\n      if (!this.chassisList || this.chassisList.length < 1) {\n        return null;\n      }\n\n      return this.chassisList.filter(chassis => !!chassis.relatedHostsIds && chassis.relatedHostsIds.indexOf(this.contextObjectId) > -1);\n    }\n\n  }\n\n  HostMonitorComponent.ɵfac = function HostMonitorComponent_Factory(t) {\n    return new (t || HostMonitorComponent)(i0.ɵɵdirectiveInject(i1.ChassisService), i0.ɵɵdirectiveInject(i2.HostsService), i0.ɵɵdirectiveInject(i3.GlobalService));\n  };\n\n  HostMonitorComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: HostMonitorComponent,\n    selectors: [[\"ng-component\"]],\n    decls: 20,\n    vars: 17,\n    consts: [[1, \"component-container\"], [3, \"clrDgLoading\", \"clrDgSelected\", \"clrDgRowSelection\", \"clrDgSelectedChange\"], [1, \"btn-group\"], [\"type\", \"button\", 1, \"btn\", \"btn-sm\", \"btn-link\", \"clr-no-border-button\", 3, \"click\"], [3, \"clrDgItem\", 4, \"clrDgItems\", \"clrDgItemsOf\"], [3, \"clrDgPageSize\"], [\"pagination\", \"\"], [3, \"clrDgItem\"], [\"href\", \"javascript:void(0)\", 3, \"click\", \"contextmenu\"], [\"shape\", \"chassisIcon\"], [3, \"isActive\"]],\n    template: function HostMonitorComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"clr-datagrid\", 1);\n        i0.ɵɵlistener(\"clrDgSelectedChange\", function HostMonitorComponent_Template_clr_datagrid_clrDgSelectedChange_1_listener($event) {\n          return ctx.selectedChassis = $event;\n        });\n        i0.ɵɵelementStart(2, \"clr-dg-action-bar\");\n        i0.ɵɵelementStart(3, \"div\", 2);\n        i0.ɵɵelementStart(4, \"button\", 3);\n        i0.ɵɵlistener(\"click\", function HostMonitorComponent_Template_button_click_4_listener() {\n          return ctx.updateChassisRelation();\n        });\n        i0.ɵɵtext(5);\n        i0.ɵɵpipe(6, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"clr-dg-placeholder\");\n        i0.ɵɵtext(8);\n        i0.ɵɵpipe(9, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"clr-dg-column\");\n        i0.ɵɵtext(11);\n        i0.ɵɵpipe(12, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"clr-dg-column\");\n        i0.ɵɵtext(14);\n        i0.ɵɵpipe(15, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(16, HostMonitorComponent_clr_dg_row_16_Template, 7, 3, \"clr-dg-row\", 4);\n        i0.ɵɵelementStart(17, \"clr-dg-footer\");\n        i0.ɵɵelement(18, \"clr-dg-pagination\", 5, 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"clrDgLoading\", ctx.loading)(\"clrDgSelected\", ctx.selectedChassis)(\"clrDgRowSelection\", true);\n        i0.ɵɵadvance(4);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(6, 9, \"vsphere.host.updateRelation\"), \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(9, 11, \"list.noData\"), \" \");\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(12, 13, \"common.name\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(15, 15, \"common.state\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"clrDgItemsOf\", ctx.chassisList);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"clrDgPageSize\", ctx.numberOfChassisPerPage);\n      }\n    },\n    directives: [i4.ClrDatagrid, i4.ÇlrDatagridMainRenderer, i4.ÇlrDatagridWillyWonka, i4.ÇlrActionableOompaLoompa, i4.ÇlrExpandableOompaLoompa, i4.ClrDatagridActionBar, i4.ClrDatagridPlaceholder, i4.ClrDatagridColumn, i4.ÇlrDatagridHeaderRenderer, i4.ClrDatagridItems, i4.ClrDatagridFooter, i4.ClrDatagridPagination, i4.ClrDatagridRow, i4.ÇlrDatagridRowRenderer, i4.ClrDatagridCell, i4.ÇlrDatagridCellRenderer, i4.ClrIconCustomTag, i5.StatusComponent],\n    pipes: [i6.TranslatePipe],\n    encapsulation: 2\n  });\n  return HostMonitorComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}